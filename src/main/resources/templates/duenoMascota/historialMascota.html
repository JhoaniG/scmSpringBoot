<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="'Historial de ' + ${mascota.nombre}">Historial de Mascota</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
          crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/stilos.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .content-wrapper {
            margin-left: 0;
            transition: margin-left 0.3s ease;
            padding-top: 80px;
        }
        #btn-menu:checked ~ .content-wrapper {
            margin-left: 250px;
        }
        .container-main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        .section-title {
            color: #fff;
            font-weight: 700;
            font-size: 2rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            margin-bottom: 2rem;
        }
        .table-responsive {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .table thead th {
            color: #333;
            font-weight: 700;
        }
        .empty-state {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            color: #666;
        }
    </style>
</head>
<body>

<div th:if="${!logueado}">
    <meta http-equiv="refresh" content="0; URL='/'" />
</div>
<div th:replace="~{fragments/menuV :: menuV}"></div>
<input type="checkbox" id="btn-menu">
<div th:replace="~{fragments/barralateralD :: barralateralD(${diagnosticoDTO}, ${mascotas}, ${veterinarios}, ${usuario})}"></div>
<div th:replace="~{fragments/barralateralD :: modalDiagnostico(${diagnosticoDTO}, ${mascotas}, ${veterinarios})}"></div>
<div class="capa"></div>

<div class="content-wrapper">
    <div class="container-main">

        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="section-title" style="margin-bottom: 0;" th:text="'Historial de ' + ${mascota.nombre}">
                <i class="fas fa-history"></i> Historial de Mascota
            </h1>
            <a th:href="@{/dueno/index}" class="btn btn-light shadow-sm">
                <i class="fas fa-arrow-left"></i> Volver al Inicio
            </a>
        </div>

        <h2 class="section-title fs-4"><i class="fas fa-stethoscope"></i> Diagnósticos</h2>
        <div class="table-responsive mb-5">
            <div th:if="${diagnosticos.isEmpty()}" class="empty-state">
                <i class="fas fa-file-alt fa-2x mb-2"></i>
                <p class="mb-0">No hay diagnósticos registrados para esta mascota.</p>
            </div>
            <table th:unless="${diagnosticos.isEmpty()}" class="table table-striped table-hover align-middle">
                <thead class="table-light">
                <tr>
                    <th scope="col">Fecha</th>
                    <th scope="col">Observaciones</th>
                    <th scope="col">Veterinario</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="diag : ${diagnosticos}">
                    <td th:text="${diag.fechaDiagnostico}"></td>
                    <td th:text="${diag.observaciones}"></td>
                    <td th:text="${diag.nombreVeterinario}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <h2 class="section-title fs-4"><i class="fas fa-calendar-alt"></i> Citas</h2>
        <div class="table-responsive">
            <div th:if="${citas.isEmpty()}" class="empty-state">
                <i class="fas fa-calendar-times fa-2x mb-2"></i>
                <p class="mb-0">No hay citas registradas para esta mascota.</p>
            </div>
            <table th:unless="${citas.isEmpty()}" class="table table-striped table-hover align-middle">
                <thead class="table-light">
                <tr>
                    <th scope="col">Fecha</th>
                    <th scope="col">Motivo</th>
                    <th scope="col">Estado</th>
                    <th scope="col">Veterinario</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="cita : ${citas}">
                    <td th:text="${#temporals.format(cita.fechaCita, 'dd/MM/yyyy')}"></td>
                    <td th:text="${cita.motivoCita}"></td>
                    <td>
                            <span th:text="${cita.estadoCita}"
                                  th:classappend="${cita.estadoCita == 'Terminada'} ? 'badge bg-success' : (${cita.estadoCita == 'Pendiente'} ? 'badge bg-warning text-dark' : 'badge bg-secondary')">
                            </span>
                    </td>
                    <td th:text="${cita.nombreVeterinario}"></td>
                </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>

<footer class="footer mt-5 bg-dark text-white">
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>